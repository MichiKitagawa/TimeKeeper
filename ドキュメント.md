思考時間: 2 ～ 3 秒


以下のドキュメントを準備すると、Cursor エディターに開発を依頼しやすくなります。各ドキュメントはシンプルかつ必須項目に絞っています。

---

## 1. プロダクト要件定義書（PRD）

* **目的・背景**
* **ターゲットユーザー**
* **コア機能一覧**

  1. 頭金管理（返金額＋手数料表示／Amazonギフト API連携）
  2. 上限時間設定（初回のみ変更不可）
  3. 自動減少ロジック（毎日1分ずつ減少）
  4. 使用時間モニタリング＆ロック
  5. ロック解除課金（200円→前回×1.2）
  6. チャレンジ完了選択（退会／継続）
* **KPI／成功指標**

  * 月間アクティブユーザー数
  * 完了チャレンジ率
  * 課金解除回数

---

## 2. 機能仕様書（FSD）

* **画面一覧／遷移図**

  * 起動画面 → 頭金入力 → 時間設定 → メイン → ロック画面 → 完了画面
* **各画面の要素定義**

  * 頭金入力画面：返金希望額＋手数料率表示＋券種選択ドロップダウン
  * メイン：残り使用時間、当日使用量プログレスバー
  * ロック画面：「アンロック」「退出」ボタン
  * 完了画面：退会／継続ボタン
* **バリデーションルール**

  * 返金希望額はギフト券券種に合わせる
  * 時間設定は 1分～1440分の整数

---

## 3. API仕様書

* **エンドポイント例**

  * `POST /api/v1/deposit`

    * リクエスト：userId, refundAmount, feeRate
    * レスポンス：transactionId, chargedAmount
  * `GET /api/v1/usage`

    * レスポンス：todayLimit, todayUsed, remainingDays
  * `POST /api/v1/unlock`

    * リクエスト：transactionId
    * レスポンス：unlockUntil
  * `POST /api/v1/complete`

    * リクエスト：transactionId
    * レスポンス：nextAction (`refund` or `continue`)
* **Amazonギフト API 連携**

  * ギフト券発行：`POST /gift-api/v1/issue` → code

---

## 4. データモデル設計書

* **テーブル／ドキュメント構造**

  * `User`（id, name, email, currentLimit, depositedAmount…）
  * `Deposit`（id, userId, refundAmount, feeRate, chargedAmount, status）
  * `UsageLog`（id, userId, date, usedMinutes）
  * `UnlockLog`（id, userId, date, fee, multiplier）
  * `Challenge`（id, userId, limit, status, startDate, endDate）

---

## 5. UIワイヤーフレーム & フロー図

* 各画面のレイアウトラフ（手書きモック or 簡易図）
* 画面遷移のフローチャート

---

## 6. テスト計画書

* **正常系テストケース**

  1. 頭金登録 → 正常にアプリ起動
  2. 毎日1分ずつ減少するか確認
  3. 上限超過 → ロック発生 → アンロック課金で解除
  4. 目標到達 → 完了画面遷移
* **異常系テストケース**

  1. 券種外の返金額入力 → エラー
  2. ネットワーク断 → APIタイムアウト処理
  3. 二重課金・多重押下 → 防止

---

## 7. 開発タスク分解（Backlog項目例）

1. 認証／ユーザー管理
2. 頭金デポジット機能
3. 自動減少バッチ処理
4. 使用状況トラッキング
5. ロック＆アンロック機能
6. ギフト券 API 連携
7. 完了／継続フロー実装
8. UI実装（各画面）
9. 単体／結合テスト

---

以上を Cursor エディターにコピペすれば、各ステップでAIに詳細実装を依頼しやすくなります。必要に応じてフォーマット調整や補足を追加してください。
